<div class="container">

  <!-- ğŸ”¹ Encabezado principal mejorado -->
 <header class="hero">
  <div class="hero-main">
    <div class="hero-kicker">Personas publicas</div>

   
    <p class="hero-subtitle">
      ClasificaciÃ³n de noticias por fecha y usuarios. Filtra rÃ¡pido y detecta tendencias con sentimiento incluido.
    </p>

    <!-- âœ… en vez de lista larga -->
    <div class="hero-chips">
      <span class="chip">âš¡ Tiempo real</span>
      <span class="chip">ğŸ“Š Tendencias por usuario</span>
      <span class="chip">ğŸ—“ï¸ Filtro por fecha</span>
      <span class="chip">ğŸ“‰ Sentimiento</span>
    </div>
  </div>

  <div class="hero-aside" aria-hidden="true">
    <div class="hero-media">
      <img src="logo2.png" alt="" />
    </div>
  </div>
</header>

  <!-- ğŸ”¹ Filtros sin estilo de card -->
   <div class="filters-section">

    <div class="filters-header">
      <h3>
        <mat-icon>tune</mat-icon>
        Filtros
      </h3>
    </div>

    <div class="filters-row">
      <!-- Fecha -->
      <mat-form-field appearance="outline" class="filter-item">
        <mat-label>Rango de fechas</mat-label>
        <mat-date-range-input [rangePicker]="picker">
          <input matStartDate placeholder="Inicio" [(ngModel)]="startDate">
          <input matEndDate placeholder="Fin" [(ngModel)]="endDate">
        </mat-date-range-input>
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-date-range-picker #picker></mat-date-range-picker>
      </mat-form-field>

      <!-- Usuarios -->
      <mat-form-field appearance="fill" class="filter-item">
        <mat-label>Seleccionar usuarios</mat-label>
        <mat-select [(ngModel)]="selectedUsers" multiple>
          <mat-option *ngFor="let user of users" [value]="user.idTweetUser">
            {{ user.TweetUser }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <!-- BÃºsqueda por texto -->
      <mat-form-field appearance="outline" class="filter-item">
        <mat-label>Buscar</mat-label>
        <input matInput [(ngModel)]="searchText" placeholder="Texto de bÃºsqueda">
      </mat-form-field>

      <!-- Botones -->
      <div class="filter-buttons">
        <button mat-flat-button color="primary" class="filter-btn"
                (click)="filtrar()">
          <mat-icon>search</mat-icon>
          Filtrar
        </button>

        <button mat-flat-button color="accent" class="filter-btn"
                >
          <mat-icon>refresh</mat-icon>
          Limpiar
        </button>
      </div>
    </div>
  </div>

  <!-- ğŸ”¹ Estado de carga -->
  <div *ngIf="cargando" class="loading">â³ Cargando noticias...</div>

  <!-- ğŸ”¹ Error -->
  <div *ngIf="error" class="error">{{ error }}</div>

  <!-- ğŸ”¹ Lista de noticias -->
  <!-- ğŸ”¹ Lista de noticias (sin tarjetas) -->
<div *ngIf="!cargando && datos.length" class="news-container">
  <div *ngFor="let item of datos" class="news-item">

    <!-- Header de la noticia -->
    <div class="news-header">
  <span class="news-title">{{ item.TweetUser }}</span>

  <div class="news-chips">
    <!-- CategorÃ­a PRO -->
    <span
      class="category-chip"
      [ngClass]="categoryClass(item.categoria)">
      <span class="cat-dot"></span>
      <span class="cat-icon">{{ categoryIcon(item.categoria) }}</span>
      <span class="cat-text">{{ item.categoria || 'Otros' }}</span>
    </span>

    <!-- Sentimiento -->
    <span
      class="status-chip"
      [ngClass]="{
        'negativo': item.sentimiento === 'negativo',
        'neutral': item.sentimiento === 'neutro',
        'positivo': item.sentimiento === 'positivo'
      }">
      {{ item.sentimiento }}
    </span>
  </div>
</div>

    <!-- Texto de la noticia -->
    <p class="news-text">{{ item.text }}</p>
    
    <!-- Fecha -->
    <div class="news-date">{{ item.created | date:'mediumDate' }}</div>
     <div class="sentiment-icons">
      <div class="icon red">
        <span class="emoji">ğŸ˜¡</span>
        <span class="count">{{ getRepliesCounts(item.tweetid).negativo }}</span>
      </div>

      <div class="icon yellow">
        <span class="emoji">ğŸ˜</span>
        <span class="count">{{ getRepliesCounts(item.tweetid).neutro }} </span>
      </div>

      <div class="icon green">
        <span class="emoji">ğŸ˜Š</span>
        <span class="count">{{ getRepliesCounts(item.tweetid).positivo }}</span>
      </div>
    </div>

  </div>
</div>


  <!-- ğŸ”¹ PaginaciÃ³n mejorada -->
  <div class="pagination">
    <button
      mat-flat-button
      color="primary"
      class="pagination-btn prev"
      (click)="load(this.startDate!.toISOString().split('T')[0], this.endDate!.toISOString().split('T')[0], selectedUsers, currentPage - 1)"
      [disabled]="currentPage === 1">
      <mat-icon>arrow_back_ios_new</mat-icon>
      Anterior
    </button>

    <span class="page-indicator">PÃ¡gina {{ currentPage }}</span>

    <button
      mat-flat-button
      color="primary"
      class="pagination-btn next"
      (click)="load(this.startDate!.toISOString().split('T')[0], this.endDate!.toISOString().split('T')[0], selectedUsers, currentPage + 1)"
      [disabled]="!hasMore">
      Siguiente
      <mat-icon>arrow_forward_ios</mat-icon>
    </button>
  </div>

  <!-- ğŸ”¹ Sin resultados -->
  <div *ngIf="!cargando && !error && datos.length === 0" class="no-results">
    <p>No hay noticias disponibles para los filtros seleccionados.</p>
  </div>
</div>


